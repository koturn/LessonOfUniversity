+------------------------------------------------------------+
| プログラムの仕様書(テトリス)                               |
|   1. プログラムの使い方                                    |
|   2. ゲーム仕様                                            |
|   3. プログラムの内部仕様                                  |
|   4. コンパイル                                            |
|   5. コーディング                                          |
|   6. その他                                                |
|                                           author : group03 |
+------------------------------------------------------------+


[ 1. プログラムの使い方 ]
プログラムの本体は、
  server
  client
の2つである。
どちらのプログラムも、コマンドライン引数を必要とする。

serverの使い方は
  $ server [ポート番号]
である。また、
  $ server
とすると、デフォルトのポート番号として50000を使用する。

clientの使い方は、
  $ client [IPアドレス] [ポート番号]
である。serverと同じく、
  $ client [IPアドレス]
とすると、デフォルトのポート番号として50000を使用する。

なお、ポート番号にウェルノウンポート(0 ~ 1023)を指定した場合は、エラーメッセー
ジを表示して、終了する。
登録済みポート番号(1024 ~ 49151)を指定した場合は、警告メッセージを表示して、
テトリスを開始する。




[ 2. ゲーム仕様 ]
テトリスの基本的な操作方法は以下のようになっている。
ブロックの移動方法はviエディタに準じたものとなっている。
  h : ブロックを左に移動
  j : ブロックを下に落とす
  l : ブロックを右に移動する
  a : ブロックを左回転する
  s : ブロックを右回転する
一応、Emacsキーバインドによるブロックの移動も可能となっており、
  Ctrl-b : ブロックを左に移動
  Ctrl-n : ブロックを下に落とす。
  Ctrl-f : ブロックを右に移動
と操作することもできる。

ゲームのルールは、
  3分以内にどちらかがゲームオーバーになるか、
  3分間過ぎるか
のどちらかの条件が満たされるまで、ゲームが続く。
どちらかがゲームオーバーになった場合、もう一方が勝利となり、
3分間経過した場合は、スコアで判定を行う。

スコアは、ブロックを消したときに加算され、
  1列消し :  100
  2列消し :  300
  3列消し :  500
  4列消し : 1000
となっている。




[ 3. プログラムの内部仕様 ]
fcntl()関数によるread()関数のノンブロッキング処理を行い、非同期通信を実現して
いる。そのため、稀に通信に失敗し、相手の画面が乱れることがある。この場合は、
一旦、プログラムを終了し、もう一度接続からやり直すこと。
また、シグナルハンドラはCtrl-Cの矯正終了のシグナルキャッチのみなので、それ以外
の条件で強制終了した場合は、相手に通知できない。




[ 4. コンパイル ]
lib/tetris.cには、cursesライブラリを用いている。
したがって、cursesライブラリがインストールされていない環境では、コンパイルでき
ない。
一例として、デフォルトのUbuntu12.04では、cursesライブラリがインストールされて
いないので、
  $ sudo apt-get install libncurses5-dev
として、インストールするとよい。
パッケージマネージャとして、yumを使用している場合は、
  $sudo yum install ncurses-devel
とするとよい。

MakefileはLinux用のMakefileであり、
Makefile.cygwinはCygwin用のMakefileである。
これらのMakefileを用いて、コンパイルするとよい。

なお、自分でコンパイル構成を変更する場合は、tetris.cがcursesに依存しているた
め、明示的にlibcurses.aとリンクを行う必要がある。すなわち、
    $ gcc -lcurses <object files> <source files> -o <output file>
として、リンクすること。
また、Cygwinは、curses.hの位置が変なので、コンパイルするときに、
    $ gcc -I/usr/include/ncurses <source files> -o <output file>
として、インクルードパスを追加しておく必要がある。




[ 5. コーディング ]
ソースコードは以下のような形式で記述した。
  インデント           : 半角スペース
  インデントカラム数   : 2
  インクルードガード   : #ifndef / #define / #endif
  文字コード           : utf-8(BOM無し)
  改行コード           : unix
ソースコードの見栄えとしては、Javaのインデントカラム数を2にしたものとなっている。
気に食わなければ、indentコマンドを使うなどして、適宜変更して構わない。




[ 6. その他 ]
プログラムの配布ライセンス形態はGPLとしておく。
これに関しての質問がある場合は、プログラム全体を担当した
  buk1097@mail4.doshisha.ac.jp
まで連絡すること。

また、doxygen形式のコメントをつけるように徹底したので、doxygenによるドキュメント
生成は自由に行って構わない。
